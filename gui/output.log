============================================================
POPULATING RAW STOCK VALUATIONS TABLE
============================================================

This will:
1. Create the raw_stock_valuations table (if needed)
2. Scrape multi-year fundamentals for all watchlist tickers
3. Store them in the database

This may take a while as it opens the browser for each ticker.

Step 1: Table creation skipped (assumed existing)...
[OK] Table ready

Step 2: Running Raw Fundamentals Loader...

Starting raw fundamentals update...
Selecting tickers from database...
Processing 165 tickers: ART.JO, BID.JO, GLN.JO, GRT.JO, NED.JO, NTC.JO, PAN.JO, PIK.JO, RBX.JO, RNI.JO, SNT.JO, SSW.JO, TKG.JO, ABG.JO, ACL.JO, ACT.JO, ADH.JO, AEG.JO, AEL.JO, AFE.JO, AFH.JO, AFT.JO, AGL.JO, ANG.JO, ANH.JO, APF.JO, APN.JO, ARI.JO, ARL.JO, ASC.JO, ATT.JO, AVI.JO, AXX.JO, BAT.JO, BEL.JO, BHG.JO, BLU.JO, BOX.JO, BTI.JO, BTN.JO, BVT.JO, BWN.JO, BYI.JO, CAA.JO, CFR.JO, CGR.JO, CHP.JO, CLH.JO, CLS.JO, CMH.JO, CML.JO, CPI.JO, CSB.JO, EMI.JO, ENX.JO, EPE.JO, EQU.JO, EUZ.JO, EXX.JO, FBR.JO, FFB.JO, FSR.JO, FTB.JO, GFI.JO, GND.JO, GNDP.JO, GPL.JO, HAR.JO, HCI.JO, HDC.JO, HMN.JO, HYP.JO, IMP.JO, INL.JO, IOC.JO, ITE.JO, IVT.JO, JBL.JO, JSE.JO, KAL.JO, KAP.JO, KIO.JO, KP2.JO, KRO.JO, KST.JO, LBR.JO, LEW.JO, LHC.JO, LSK.JO, LTE.JO, MCZ.JO, MDI.JO, MKR.JO, MNP.JO, MPT.JO, MRF.JO, MRP.JO, MSP.JO, MST.JO, MTA.JO, MTH.JO, MTM.JO, MTN.JO, MTU.JO, N91.JO, NPH.JO, NPK.JO, NPN.JO, NRP.JO, NTU.JO, OCE.JO, OCT.JO, OMN.JO, OMU.JO, ORN.JO, OUT.JO, PHP.JO, PMR.JO, PPC.JO, PPE.JO, PPH.JO, PRX.JO, QLT.JO, RBO.JO, RCL.JO, RDF.JO, REM.JO, REN.JO, RES.JO, RLO.JO, RMH.JO, S32.JO, SAC.JO, SAP.JO, SBK.JO, SBP.JO, SBPP.JO, SDO.JO, SEA.JO, SEP.JO, SHC.JO, SHP.JO, SNV.JO, SOL.JO, SPG.JO, SPP.JO, SRE.JO, SSU.JO, SUI.JO, SUR.JO, SYG.JO, TBS.JO, TFG.JO, TGA.JO, THA.JO, TRU.JO, TSG.JO, WBC.JO, WBO.JO, WHL.JO, WVR.JO, YRK.JO, ZED.JO, ZZD.JO, SSK.JO

============================================================
Processing ART.JO...
  Found tables: ['fin_I', 'fin_B', 'fin_C', 'fin_S', 'fin_R']
    [DEBUG] Share Stats Headers: ['', '', '', '']
    [DEBUG] Growth column index: 1
    [DEBUG] Year column indices: [2, 3]
  Error scraping ART.JO: 'charmap' codec can't encode character '\u26a0' in position 4: character maps to <undefined>
Traceback (most recent call last):
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 403, in _parse_period_label
    self.log(f"    \u26a0 Could not parse period label: '{header}'")
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u26a0' in position 4: character maps to <undefined>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 143, in _scrape_multi_year_fundamentals
    share_stats_periods = self._parse_multi_year_share_statistics(tables['fin_S'])
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 242, in _parse_multi_year_share_statistics
    period_end = self._parse_period_label(period_label)
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 431, in _parse_period_label
    self.log(f"    \u26a0 Error parsing period label '{header}': {e}")
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u26a0' in position 4: character maps to <undefined>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 69, in run_fundamentals_update
    periods_data = await self._scrape_multi_year_fundamentals(ticker)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 175, in _scrape_multi_year_fundamentals
    self.log(f"  Traceback: {traceback.format_exc()}")
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u26a0' in position 205: character maps to <undefined>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\populate_raw_fundamentals.py", line 65, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\populate_raw_fundamentals.py", line 43, in main
    result = await loader.run_fundamentals_update(tickers=None)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diond\Desktop\PROJECTS\GITHUBPROJECTS\stock_analysis\gui\raw_fundamentals_loader.py", line 90, in run_fundamentals_update
    self.log(f"  \u274c Error processing {ticker}: {type(e).__name__}: {str(e)}")
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diond\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u274c' in position 2: character maps to <undefined>
